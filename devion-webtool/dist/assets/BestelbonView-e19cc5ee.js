import{D as v,L as S}from"./LoadingAnimation-baca3cd3.js";import{B as I,G as _}from"./global-d1d627d6.js";import{_ as x,w as f,v as B,o as p,c as b,a as l,t as m,F as D,r as g,p as O,b as V,d as F,e as h,f as d,g as z}from"./index-894bacca.js";import{T as C,L}from"./LabelDevion-e66deda4.js";const P={props:{showTabel:Boolean,bestelbonNr:String,showError:Boolean,showInfo:Boolean,artikels:Array}},Z=o=>(O("data-v-dcd94a6c"),o=o(),V(),o),M={class:"c-label--error"},q=Z(()=>l("thead",null,[l("tr",null,[l("th",null,"Artikel"),l("th",null,"Aantal"),l("th",null,"Omschrijving")])],-1));function H(o,t,n,s,e,r){return f((p(),b("div",null,[l("h1",null," bestelbon "+m(n.bestelbonNr),1),f(l("h3",M," Er zijn geen artikels bij deze bestelbon!",512),[[B,n.showError]]),(p(!0),b(D,null,g(n.artikels,a=>f((p(),b("div",{key:a.leverancier.name},[l("h3",null,m(a.leverancier.name),1),l("table",null,[q,l("tbody",null,[(p(!0),b(D,null,g(a.leverancier.artikels,i=>(p(),b("tr",{key:i.artikelNummer},[l("td",null,m(i.artikelNummer),1),l("td",null,m(i.aantal),1),l("td",null,m(i.omschrijving),1)]))),128))])])])),[[B,n.showInfo]])),128))],512)),[[B,n.showTabel]])}const N=x(P,[["render",H],["__scopeId","data-v-dcd94a6c"]]);const J={props:{label:String,placeholder:String},data(){return{selectedOption:null}},watch:{placeholder(o){this.selectedOption=o}},methods:{emitSelectedOption(){this.$emit("option-selected",this.selectedOption)}}},K={class:"c-checkbox"},Q={for:"checkbox"};function W(o,t,n,s,e,r){return p(),b("div",K,[f(l("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":t[0]||(t[0]=a=>e.selectedOption=a),onChange:t[1]||(t[1]=(...a)=>r.emitSelectedOption&&r.emitSelectedOption(...a)),name:"checkbox"},null,544),[[F,e.selectedOption]]),l("label",Q,m(n.placeholder),1)])}const y=x(J,[["render",W],["__scopeId","data-v-6dd1227a"]]);let T=[],c="companies",u="",k="",w="",E=!1;const X={components:{Dropdown:v,ButtonDevion:I,TabelBestelbon:N,textInput:C,LoadingAnimation:S,labelDevion:L,checkboxInput:y},data(){return{dropdownCompanies:{components:{Dropdown:v},id:"dropdownCompanies",label:"Bedrijf",options:T,error:!1},dropdownBestelbon:{components:{Dropdown:v},id:"dropdownBestelbon",label:"Bestelbon",options:[],error:!1},buttonDevion:{components:{ButtonDevion:I},label:"Download bestelbon",isButtonDisabled:!0,showButton:!0,methods:{handleButtonClick(){},toggleButtonState(){this.isButtonDisabled=!this.isButtonDisabled}}},tabelBestelbon:{components:{TabelBestelbon:N},showTabel:!1,bestelbonNr:"",showError:!1,showInfo:!0,artikels:[]},seperator:{components:{textInput:C},id:"seperator",label:"Seperator",options:[],error:!1,errorText:"Seperator is verplicht"},loading:{components:{LoadingAnimation:S},showLoad:!1},error:{components:{labelDevion:L},label:"Bestelbon niet gevonden",showLabel:!1},checkboxInput:{components:{checkboxInput:y},id:"checkboxInput",label:"Force csv"}}},created(){_(c).then(o=>o).then(o=>{const t=[];for(var n of o)t.push({value:n,label:n});this.dropdownCompanies.options=t,this.dropdownCompanies.selected=this.dropdownCompanies.options.find(s=>s.label.toLowerCase()=="devion").value,u=this.dropdownCompanies.selected,c=`${u}/ets/openpurchaseorderids`,_(c).then(s=>s).then(s=>{s.sort(),s.reverse();for(var e of s)this.dropdownBestelbon.options.push({value:e,label:e})})})},beforeUnmount(){T=[],c="companies",u="",k="",w=""},methods:{async handledropdownCompaniesSelected(o){u=o,c=`${u}/ets/openpurchaseorderids`,_(c).then(t=>t).then(t=>{t.sort(),t.reverse(),this.dropdownBestelbon.options=[];for(var n of t)this.dropdownBestelbon.options.push({value:n,label:n})})},async handledropdownBestelbonSelected(o){k=o,this.buttonDevion.isButtonDisabled=!1;const t={id:o};c=`${u}/ets/purchaseorder?${new URLSearchParams(t)}`,this.tabelBestelbon.showTabel=!1,this.loading.showLoad=!0,_(c).then(n=>(this.loading.showLoad=!1,n)).then(n=>{if(n!=null)if(this.tabelBestelbon.showTabel=!0,this.tabelBestelbon.bestelbonNr=n.bonNummer,n.artikels.length==0)this.tabelBestelbon.showError=!0,this.tabelBestelbon.showInfo=!1;else{this.tabelBestelbon.showError=!1,this.tabelBestelbon.showInfo=!0;let s=[],e=[];for(const r of n.artikels)e.includes(r.leverancier)||e.push(r.leverancier);for(const r of e){let a=[];for(const i of n.artikels)i.leverancier==r&&(i.artikelNummer!="VERZENDING"||i.omschrijving!="VERZENDING")&&a.push({artikelNummer:i.artikelNummer,aantal:i.aantal,omschrijving:i.omschrijving});s.push({leverancier:{name:r,artikels:a}})}this.tabelBestelbon.artikels=s}else this.tabelBestelbon.showTabel=!1})},handletextInputSelected(o){o==null?w=" ":o.includes("\\t")?w=o.replace("\\t","	"):w=o},async BestelbonDownload(){if(w=="")this.seperator.error=!0,this.seperator.errorText="Seperator is verplicht";else{this.seperator.error=!1;const o={id:k,seperator:w,forceCSV:E};c=`${u.toLocaleLowerCase()}/ets/createpurchasefile?${new URLSearchParams(o)}`,_(c).then(t=>{if(console.log(t),t.status){this.error.showLabel=!0,this.error.label=t.detail;return}else this.error.showLabel=!1;var n=atob(t.fileContents),s=new Blob([n],{type:t.contentType});const e=document.createElement("a");e.href=URL.createObjectURL(s),e.download=t.fileDownloadName,document.body.appendChild(e),e.click(),document.body.removeChild(e)})}},handlecheckboxInputSelected(o){console.log(o),E=o}}},Y=o=>(O("data-v-0eee9b9e"),o=o(),V(),o),$=Y(()=>l("h1",null,"Bestelbon",-1)),ee={key:0,class:"c-load"};function oe(o,t,n,s,e,r){const a=h("Dropdown"),i=h("textInput"),j=h("checkboxInput"),A=h("ButtonDevion"),R=h("LoadingAnimation"),U=h("labelDevion"),G=h("TabelBestelbon");return p(),b("div",null,[$,d(a,{id:e.dropdownCompanies.id,label:e.dropdownCompanies.label,options:e.dropdownCompanies.options,error:e.dropdownCompanies.error,onOptionSelected:r.handledropdownCompaniesSelected,class:"c-dropdown",selected:e.dropdownCompanies.selected},null,8,["id","label","options","error","onOptionSelected","selected"]),d(a,{id:e.dropdownBestelbon.id,label:e.dropdownBestelbon.label,options:e.dropdownBestelbon.options,error:e.dropdownBestelbon.error,onOptionSelected:r.handledropdownBestelbonSelected,class:"c-dropdown"},null,8,["id","label","options","error","onOptionSelected"]),d(i,{id:e.seperator.id,label:e.seperator.label,error:e.seperator.error,placeholder:e.seperator.label,errorText:e.seperator.errorText,onOptionSelected:r.handletextInputSelected,class:"c-text-input"},null,8,["id","label","error","placeholder","errorText","onOptionSelected"]),d(j,{id:e.checkboxInput.id,label:e.checkboxInput.label,placeholder:e.checkboxInput.label,onOptionSelected:r.handlecheckboxInputSelected,class:"c-checkbox-input"},null,8,["id","label","placeholder","onOptionSelected"]),d(A,{label:e.buttonDevion.label,isDisabled:e.buttonDevion.isButtonDisabled,onClick:r.BestelbonDownload,class:"c-button-artikel-search",showButton:e.buttonDevion.showButton},null,8,["label","isDisabled","onClick","showButton"]),e.loading.showLoad?(p(),b("div",ee,[d(R,{showLoad:e.loading.showLoad},null,8,["showLoad"])])):z("",!0),d(U,{label:e.error.label,showLabel:e.error.showLabel,class:"c-artikel-error"},null,8,["label","showLabel"]),d(G,{showTabel:e.tabelBestelbon.showTabel,bestelbonNr:e.tabelBestelbon.bestelbonNr,showError:e.tabelBestelbon.showError,showInfo:e.tabelBestelbon.showInfo,artikels:e.tabelBestelbon.artikels},null,8,["showTabel","bestelbonNr","showError","showInfo","artikels"])])}const re=x(X,[["render",oe],["__scopeId","data-v-0eee9b9e"]]);export{re as default};
