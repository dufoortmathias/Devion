import{d as v,B as D,t as S,L as I,G as _}from"./LabelDevion-940e8072.js";import{_ as x,w as f,v as B,o as b,c as h,a as s,t as m,F as C,r as g,p as R,b as U,d as G,e as u,f as d}from"./index-624f8bce.js";const A={props:{showTabel:Boolean,bestelbonNr:String,showError:Boolean,showInfo:Boolean,artikels:Array}},F=o=>(R("data-v-dcd94a6c"),o=o(),U(),o),z={class:"c-label--error"},M=F(()=>s("thead",null,[s("tr",null,[s("th",null,"Artikel"),s("th",null,"Aantal"),s("th",null,"Omschrijving")])],-1));function P(o,t,n,l,e,r){return f((b(),h("div",null,[s("h1",null," bestelbon "+m(n.bestelbonNr),1),f(s("h3",z," Er zijn geen artikels bij deze bestelbon!",512),[[B,n.showError]]),(b(!0),h(C,null,g(n.artikels,a=>f((b(),h("div",{key:a.leverancier.name},[s("h3",null,m(a.leverancier.name),1),s("table",null,[M,s("tbody",null,[(b(!0),h(C,null,g(a.leverancier.artikels,i=>(b(),h("tr",{key:i.artikelNummer},[s("td",null,m(i.artikelNummer),1),s("td",null,m(i.aantal),1),s("td",null,m(i.omschrijving),1)]))),128))])])])),[[B,n.showInfo]])),128))],512)),[[B,n.showTabel]])}const N=x(A,[["render",P],["__scopeId","data-v-dcd94a6c"]]);const Z={props:{label:Object,placeholder:String},data(){return{selectedOption:null}},watch:{placeholder(o){this.selectedOption=o}},methods:{emitSelectedOption(){this.$emit("option-selected",this.selectedOption)}}},q={class:"c-checkbox"},H={for:"checkbox"};function J(o,t,n,l,e,r){return b(),h("div",q,[f(s("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":t[0]||(t[0]=a=>e.selectedOption=a),onChange:t[1]||(t[1]=(...a)=>r.emitSelectedOption&&r.emitSelectedOption(...a)),name:"checkbox"},null,544),[[G,e.selectedOption]]),s("label",H,m(n.placeholder),1)])}const y=x(Z,[["render",J],["__scopeId","data-v-24c13292"]]);let T=[],c="companies",p="",k="",w="",L=!1;const K={components:{Dropdown:v,ButtonDevion:D,TabelBestelbon:N,textInput:S,labelDevion:I,checkboxInput:y},data(){return{dropdownCompanies:{components:{Dropdown:v},id:"dropdownCompanies",label:"Bedrijf",options:T,error:!1},dropdownBestelbon:{components:{Dropdown:v},id:"dropdownBestelbon",label:"Bestelbon",options:[],error:!1},buttonDevion:{components:{ButtonDevion:D},label:"Download bestelbon",isButtonDisabled:!0,showButton:!0,methods:{handleButtonClick(){},toggleButtonState(){this.isButtonDisabled=!this.isButtonDisabled}}},tabelBestelbon:{components:{TabelBestelbon:N},showTabel:!1,bestelbonNr:"",showError:!1,showInfo:!0,artikels:[]},seperator:{components:{textInput:S},id:"seperator",label:"Seperator",options:[],error:!1,errorText:"Seperator is verplicht"},error:{components:{labelDevion:I},label:"Bestelbon niet gevonden",showLabel:!1},checkboxInput:{components:{checkboxInput:y},id:"checkboxInput",label:"Force csv"}}},created(){_(c).then(o=>o).then(o=>{const t=[];for(var n of o)t.push({value:n,label:n});this.dropdownCompanies.options=t,this.dropdownCompanies.selected=this.dropdownCompanies.options.find(l=>l.label.toLowerCase()=="devion").value,p=this.dropdownCompanies.selected,c=`${p}/ets/openpurchaseorderids`,_(c).then(l=>l).then(l=>{l.sort(),l.reverse();for(var e of l)this.dropdownBestelbon.options.push({value:e,label:e})})})},beforeUnmount(){T=[],c="companies",p="",k="",w=""},methods:{async handledropdownCompaniesSelected(o){p=o,c=`${p}/ets/openpurchaseorderids`,_(c).then(t=>t).then(t=>{t.sort(),t.reverse();for(var n of t)this.dropdownBestelbon.options.push({value:n,label:n})})},async handledropdownBestelbonSelected(o){k=o,this.buttonDevion.isButtonDisabled=!1;const t={id:o};c=`${p}/ets/purchaseorder?${new URLSearchParams(t)}`,_(c).then(n=>n).then(n=>{if(n!=null)if(this.tabelBestelbon.showTabel=!0,this.tabelBestelbon.bestelbonNr=n.bonNummer,n.artikels.length==0)this.tabelBestelbon.showError=!0,this.tabelBestelbon.showInfo=!1;else{this.tabelBestelbon.showError=!1,this.tabelBestelbon.showInfo=!0;let l=[],e=[];for(const r of n.artikels)e.includes(r.leverancier)||e.push(r.leverancier);for(const r of e){let a=[];for(const i of n.artikels)i.leverancier==r&&(i.artikelNummer!="VERZENDING"||i.omschrijving!="VERZENDING")&&a.push({artikelNummer:i.artikelNummer,aantal:i.aantal,omschrijving:i.omschrijving});l.push({leverancier:{name:r,artikels:a}})}this.tabelBestelbon.artikels=l}else this.tabelBestelbon.showTabel=!1})},handletextInputSelected(o){o==null?w=" ":o.includes("\\t")?w=o.replace("\\t","	"):w=o},async BestelbonDownload(){if(w=="")this.seperator.error=!0,this.seperator.errorText="Seperator is verplicht";else{this.seperator.error=!1;const o={id:k,seperator:w,forceCSV:L};c=`${p.toLocaleLowerCase()}/ets/createpurchasefile?${new URLSearchParams(o)}`,_(c).then(t=>{if(console.log(t),t.status){this.error.showLabel=!0,this.error.label=t.detail;return}else this.error.showLabel=!1;var n=atob(t.fileContents),l=new Blob([n],{type:t.contentType});const e=document.createElement("a");e.href=URL.createObjectURL(l),e.download=t.fileDownloadName,document.body.appendChild(e),e.click(),document.body.removeChild(e)})}},handlecheckboxInputSelected(o){console.log(o),L=o}}};function Q(o,t,n,l,e,r){const a=u("Dropdown"),i=u("textInput"),E=u("checkboxInput"),O=u("ButtonDevion"),j=u("labelDevion"),V=u("TabelBestelbon");return b(),h("div",null,[d(a,{id:e.dropdownCompanies.id,label:e.dropdownCompanies.label,options:e.dropdownCompanies.options,error:e.dropdownCompanies.error,onOptionSelected:r.handledropdownCompaniesSelected,class:"c-dropdown",selected:e.dropdownCompanies.selected},null,8,["id","label","options","error","onOptionSelected","selected"]),d(a,{id:e.dropdownBestelbon.id,label:e.dropdownBestelbon.label,options:e.dropdownBestelbon.options,error:e.dropdownBestelbon.error,onOptionSelected:r.handledropdownBestelbonSelected,class:"c-dropdown"},null,8,["id","label","options","error","onOptionSelected"]),d(i,{id:e.seperator.id,label:e.seperator.label,error:e.seperator.error,placeholder:e.seperator.label,errorText:e.seperator.errorText,onOptionSelected:r.handletextInputSelected,class:"c-text-input"},null,8,["id","label","error","placeholder","errorText","onOptionSelected"]),d(E,{id:e.checkboxInput.id,label:e.checkboxInput.label,placeholder:e.checkboxInput.label,onOptionSelected:r.handlecheckboxInputSelected,class:"c-checkbox-input"},null,8,["id","label","placeholder","onOptionSelected"]),d(O,{label:e.buttonDevion.label,isDisabled:e.buttonDevion.isButtonDisabled,onClick:r.BestelbonDownload,class:"c-button-artikel-search",showButton:e.buttonDevion.showButton},null,8,["label","isDisabled","onClick","showButton"]),d(j,{label:e.error.label,showLabel:e.error.showLabel,class:"c-artikel-error"},null,8,["label","showLabel"]),d(V,{showTabel:e.tabelBestelbon.showTabel,bestelbonNr:e.tabelBestelbon.bestelbonNr,showError:e.tabelBestelbon.showError,showInfo:e.tabelBestelbon.showInfo,artikels:e.tabelBestelbon.artikels},null,8,["showTabel","bestelbonNr","showError","showInfo","artikels"])])}const Y=x(K,[["render",Q],["__scopeId","data-v-61266c1e"]]);export{Y as default};
