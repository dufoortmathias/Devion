import{_ as A,w as N,v as j,o as c,c as u,a as r,t as k,e as b,F as E,r as K,n as v,f as a,g as C}from"./index-48af5818.js";import{B as f,a as _,L as y,P as G,b as W}from"./LabelDevion-9fc54128.js";import{A as T}from"./ArtikelForm-fb4859dd.js";const Z={props:{error:Boolean,label:String,filename:String,showFile:Boolean},components:{},data(){return{}},methods:{onFileChange(t){const s=t.target.files[0],l=new FileReader;s&&(l.readAsDataURL(s),l.onload=()=>{s.previewBase64=l.result,this.$emit("file-updated",s),console.log(s)},l.onerror=w=>{console.error(w)})}}},z={class:"c-input-placement"},J={class:"c-label c-label-file"},M={key:0,class:"c-input-file"},q={class:"file-label c-error",for:"file-input"},H={class:"c-label--error"},Q={key:1,class:"c-input-file"},X={class:"file-label",for:"file-input"};function Y(t,s,l,w,e,o){return N((c(),u("div",z,[r("label",J,k(l.label)+": ",1),l.error?(c(),u("div",M,[r("input",{id:"file-input",class:"o-hide-accessible",type:"file",accept:".xlsx, .xls, .csv",onChange:s[0]||(s[0]=d=>o.onFileChange(d))},null,32),r("label",q,k(l.filename),1),r("label",H,k(l.label)+" is verplicht!",1)])):(c(),u("div",Q,[r("input",{id:"file-input",class:"o-hide-accessible",type:"file",accept:".xlsx, .xls, .csv",onChange:s[1]||(s[1]=d=>o.onFileChange(d))},null,32),r("label",X,k(l.filename),1)]))],512)),[[j,l.showFile]])}const I=A(Z,[["render",Y],["__scopeId","data-v-18d74bb7"]]);const $={name:"TreeView",props:{jsonData:Array,showTree:Boolean},components:{},data(){return{expanded:!1}},methods:{toggleNode(t){t.expanded=!t.expanded},hasChildParts(t){return t.parts&&t.parts.length>0}}},ee={class:"treeview"},te=["onClick"],se={key:0};function le(t,s,l,w,e,o){const d=b("TreeView",!0);return N((c(),u("ul",ee,[(c(!0),u(E,null,K(l.jsonData,(n,p)=>(c(),u("li",{key:p,class:"c-placement"},[r("div",null,[r("span",{onClick:g=>o.toggleNode(n),class:v([{caret:o.hasChildParts(n),"no-caret":!o.hasChildParts(n),"caret-down":n.expanded,exists:n.existsETS,"not-exists":!n.existsETS},"c-text"])},k(n.number)+" ("+k(n.description)+") ",11,te)]),n.parts&&n.expanded?(c(),u("ul",se,[a(d,{jsonData:n.parts,showTree:!0},null,8,["jsonData"])])):C("",!0)]))),128))],512)),[[j,l.showTree]])}const V=A($,[["render",le],["__scopeId","data-v-8bb2e7c8"]]);let P=null,S=null,h=[],m=0,D=0,i,F,L,B=[],oe;const ne={components:{ExcelFileInput:I,ButtonDevion:f,TreeView:V,ArtikelForm:T,LabelDevion:_,LoadingAnimation:y},data(){return{file:{components:{ExcelFileInput:I},id:"file",label:"assembly file",error:!1,showLabel:!0,filename:"Kies een bestand",showFile:!0},button:{components:{ButtonDevion:f},label:"IMPORTEREN",isDisabled:!1,showButton:!0},treeView:{components:{TreeView:V},showTree:!1,jsonData:null},buttonSave:{components:{ButtonDevion:f},label:"ARTIKELEN OPSLAAN",isDisabled:!1,showButton:!0},buttonInsert:{components:{ButtonDevion:f},label:"LINKEN",isDisabled:!1,showButton:!0},artikelForm:{components:{ArtikelForm:T},showform:!1,data:null,check:!1},save:{components:{ButtonDevion:f},label:"OPSLAAN",isButtonDisabled:!1,showButton:!1},next:{components:{ButtonDevion:f},label:"VOLGENDE",isButtonDisabled:!1,showButton:!1},prev:{components:{ButtonDevion:f},label:"VORIGE",isButtonDisabled:!1,showButton:!1},artikelProgress:{components:{LabelDevion:_},label:"Artikel 1 van 1",showLabel:!1},missing:{components:{LabelDevion:_},label:"Artikel niet gevonden 0/0",showlabel:!1},loading:{components:{LoadingAnimation:y},showLoad:!1},linked:{components:{LabelDevion:_},label:"artikelen gekoppeld",showlabel:!1}}},methods:{handleFileUpdate(t){this.file.error=!1,this.file.showLabel=!1,this.file.showButton=!0,this.file.filename=t.name,this.file.file=t},async handleButton(){this.loading.showLoad=!0;let t="devion/ets/transformbomexcel";P=this.file.file.previewBase64.replace("data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,",""),S=this.file.filename;var s={FileContents:P};t+="?fileName="+S,G(t,s).then(l=>{let w=JSON.parse(l);for(let e of w)e&&B.push(e);this.loading.showLoad=!1,this.treeView.showTree=!0,this.treeView.jsonData=B,m=0,D=0;for(let e of B)e&&(console.log(e),this.checkArtikel(e));m>0?this.missing.showlabel=!0:this.missing.showlabel=!1,this.missing.label="Artikels niet gevonden "+m+"/"+D})},handleButtonSave(){m>0&&(this.artikelForm.showform=!0,i=89,this.artikelForm.data=h[i],this.save.showButton=!0,this.next.showButton=!0,this.prev.showButton=!0,this.artikelProgress.showLabel=!0,this.artikelProgress.label="Artikel 1/"+h.length,this.file.showFile=!1,this.button.showButton=!1,this.treeView.showTree=!1,this.buttonSave.showButton=!1,this.buttonInsert.showButton=!1,this.missing.showlabel=!1)},checkArtikel(t){if(D++,t){if(t.parts)for(let s of t.parts)this.checkArtikel(s);t.existsETS==!1&&(h.includes(t)?console.log("already in array"):(h.push(t),m++))}},async handleButtonInsert(){m>0?(this.artikelForm.showform=!0,i=0,this.artikelForm.data=h[i],this.save.showButton=!1,this.next.showButton=!0,this.prev.showButton=!1,this.artikelProgress.showLabel=!0,this.artikelProgress.label="Artikel 1/"+h.length,this.file.showFile=!1,this.button.showButton=!1,this.treeView.showTree=!1,this.buttonSave.showButton=!1,this.buttonInsert.showButton=!1,this.missing.showlabel=!1):(this.loading.showLoad=!0,W("devion/ets/updatelinkedarticles",B).then(t=>{console.log(t),this.loading.showLoad=!1,this.linked.showlabel=!0}).error(t=>{console.error(t)}))},handleArtikel(t){let s=t;oe[i]=s,L==!0?(console.log("saved"),this.artikelForm.showform=!1,this.save.showButton=!1,this.next.showButton=!1,this.prev.showButton=!1,this.artikelProgress.showLabel=!1,this.file.showFile=!0,this.button.showButton=!0,this.treeView.showTree=!0,this.buttonSave.showButton=!0,this.buttonInsert.showButton=!0,this.handleButton()):(L=!1,i=F,i==h.length-1?(this.next.showButton=!1,this.save.showButton=!0,this.artikelProgress.label=`Artikel ${i+1}/${h.length}`):i==0?(this.next.showButton=!0,this.save.showButton=!1,this.prev.showButton=!1,this.artikelProgress.label=`Artikel ${i+1}/${h.length}`):(this.next.showButton=!0,this.save.showButton=!1,this.prev.showButton=!0,this.artikelProgress.label=`Artikel ${i+1}/${h.length}`),this.ArtikelZoeken())},ArtikelZoeken(){this.artikelForm.showform=!0,this.artikelForm.data=h[i],this.artikelForm.check=!0,this.file.showFile=!1,this.button.showButton=!1,this.treeView.showTree=!1,this.buttonSave.showButton=!1,this.buttonInsert.showButton=!1},handleNextButtonClick(){F=i+1,this.$refs.article.createInfoObject()},handlePrevButtonClick(){F=i-1,this.$refs.article.createInfoObject()},handleSaveButtonClick(){L=!0,this.$refs.article.createInfoObject()}}},ie={key:0,class:"c-load"},ae={key:1,class:"c-buttons"},re={class:"c-artikel-form"},he={class:"c-artikel-progress"};function ce(t,s,l,w,e,o){const d=b("excelFileInput"),n=b("ButtonDevion"),p=b("LoadingAnimation"),g=b("labelDevion"),O=b("TreeView"),R=b("LabelDevion"),U=b("artikelForm"),x=b("buttonDevion");return c(),u(E,null,[a(d,{label:e.file.label,error:e.file.error,filename:e.file.filename,showFile:e.file.showFile,onFileUpdated:o.handleFileUpdate},null,8,["label","error","filename","showFile","onFileUpdated"]),a(n,{label:e.button.label,isDisabled:e.button.isDisabled,showButton:e.button.showButton,onClick:o.handleButton,class:"c-button"},null,8,["label","isDisabled","showButton","onClick"]),e.loading.showLoad?(c(),u("div",ie,[a(p,{showLoad:e.loading.showLoad},null,8,["showLoad"])])):C("",!0),a(g,{label:e.missing.label,showLabel:e.missing.showlabel,class:"c-artikel-missing"},null,8,["label","showLabel"]),a(O,{jsonData:e.treeView.jsonData,showTree:e.treeView.showTree},null,8,["jsonData","showTree"]),e.treeView.showTree?(c(),u("div",ae,[a(n,{label:e.buttonSave.label,isDisabled:e.buttonSave.isDisabled,showButton:e.buttonSave.showButton,onClick:o.handleButtonSave,class:"c-button c-button-tree"},null,8,["label","isDisabled","showButton","onClick"]),a(n,{label:e.buttonInsert.label,isDisabled:e.buttonInsert.isDisabled,showButton:e.buttonInsert.showButton,onClick:o.handleButtonInsert,class:"c-button c-button-tree"},null,8,["label","isDisabled","showButton","onClick"])])):C("",!0),a(R,{label:e.linked.label,showLabel:e.linked.showlabel,class:"c-linked"},null,8,["label","showLabel"]),r("div",re,[a(U,{showform:e.artikelForm.showform,data:e.artikelForm.data,onObjectArtikel:o.handleArtikel,class:"c-form",check:e.artikelForm.check,ref:"article"},null,8,["showform","data","onObjectArtikel","check"]),r("div",{class:v(["c-artikel-button--save",{"o-hide-accessible":!e.save.showButton}])},[a(x,{label:e.save.label,isDisabled:e.save.isButtonDisabled,showButton:e.save.showButton,onClick:o.handleSaveButtonClick,class:"c-button-artikel--next"},null,8,["label","isDisabled","showButton","onClick"])],2),r("div",{class:v(["c-artikel-button--next",{"o-hide-accessible":!e.next.showButton}])},[a(x,{label:e.next.label,isDisabled:e.next.isButtonDisabled,showButton:e.next.showButton,onClick:o.handleNextButtonClick,class:"c-button-artikel--next"},null,8,["label","isDisabled","showButton","onClick"])],2),r("div",{class:v(["c-artikel-button--prev",{"o-hide-accessible":!e.prev.showButton}])},[a(x,{label:e.prev.label,isDisabled:e.prev.isButtonDisabled,showButton:e.prev.showButton,onClick:o.handlePrevButtonClick,class:"c-button-artikel--prev"},null,8,["label","isDisabled","showButton","onClick"])],2),r("div",he,[a(g,{label:e.artikelProgress.label,showLabel:e.artikelProgress.showLabel,class:"c-artikel-progress__text"},null,8,["label","showLabel"])])])],64)}const fe=A(ne,[["render",ce],["__scopeId","data-v-a9de506a"]]);export{fe as default};
